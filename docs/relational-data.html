<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 8 Relational Data | Guided Exercises: Relational Data</title>
  <meta name="description" content="A mini bookdown tutorial book on how to make bookdown books." />
  <meta name="generator" content="bookdown 0.22 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 8 Relational Data | Guided Exercises: Relational Data" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="A mini bookdown tutorial book on how to make bookdown books." />
  <meta name="github-repo" content="openscapes/series" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 8 Relational Data | Guided Exercises: Relational Data" />
  
  <meta name="twitter:description" content="A mini bookdown tutorial book on how to make bookdown books." />
  

<meta name="author" content="Julie Lowndes" />


<meta name="date" content="2021-09-02" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="programming.html"/>
<link rel="next" href="selected-solutions.html"/>
<script src="libs/header-attrs-2.9/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="lib/css/bootstrap.min.css" type="text/css" />
<link rel="stylesheet" href="lib/css/style.css" type="text/css" />
<link rel="stylesheet" href="lib/css/lesson.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Mini Bookdown Tutorial</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> output: bookdown::gitbook</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#learn-all-about-bookdown"><i class="fa fa-check"></i><b>1.1</b> Learn all about Bookdown</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="the-rproject.html"><a href="the-rproject.html"><i class="fa fa-check"></i><b>2</b> The <code>Rproject</code></a></li>
<li class="chapter" data-level="3" data-path="intro-to-r.html"><a href="intro-to-r.html"><i class="fa fa-check"></i><b>3</b> Intro to R</a>
<ul>
<li class="chapter" data-level="3.1" data-path="intro-to-r.html"><a href="intro-to-r.html#basic-summary-statistics"><i class="fa fa-check"></i><b>3.1</b> Basic summary statistics</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="intro-to-r.html"><a href="intro-to-r.html#exercise"><i class="fa fa-check"></i><b>3.1.1</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="intro-to-r.html"><a href="intro-to-r.html#basic-histogram"><i class="fa fa-check"></i><b>3.2</b> Basic histogram</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="intro-to-r.html"><a href="intro-to-r.html#exercise-1"><i class="fa fa-check"></i><b>3.2.1</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="intro-to-r.html"><a href="intro-to-r.html#creating-vectors"><i class="fa fa-check"></i><b>3.3</b> Creating Vectors</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="intro-to-r.html"><a href="intro-to-r.html#exercise-2"><i class="fa fa-check"></i><b>3.3.1</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="intro-to-r.html"><a href="intro-to-r.html#comparing-vectors"><i class="fa fa-check"></i><b>3.4</b> Comparing Vectors</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="intro-to-r.html"><a href="intro-to-r.html#exercise-3"><i class="fa fa-check"></i><b>3.4.1</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="intro-to-r.html"><a href="intro-to-r.html#creating-a-tibble"><i class="fa fa-check"></i><b>3.5</b> Creating a tibble</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="intro-to-r.html"><a href="intro-to-r.html#exercise-4"><i class="fa fa-check"></i><b>3.5.1</b> Exercise</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="cleaning-data-i.html"><a href="cleaning-data-i.html"><i class="fa fa-check"></i><b>4</b> Cleaning Data I</a>
<ul>
<li class="chapter" data-level="4.1" data-path="cleaning-data-i.html"><a href="cleaning-data-i.html#the-pipe"><i class="fa fa-check"></i><b>4.1</b> The Pipe</a></li>
<li class="chapter" data-level="4.2" data-path="cleaning-data-i.html"><a href="cleaning-data-i.html#the-clean_names-function"><i class="fa fa-check"></i><b>4.2</b> The <code>clean_names</code> function</a></li>
<li class="chapter" data-level="4.3" data-path="cleaning-data-i.html"><a href="cleaning-data-i.html#the-select-function"><i class="fa fa-check"></i><b>4.3</b> The <code>select</code> function</a></li>
<li class="chapter" data-level="4.4" data-path="cleaning-data-i.html"><a href="cleaning-data-i.html#the-filter-function"><i class="fa fa-check"></i><b>4.4</b> The <code>filter</code> function</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="cleaning-data-i.html"><a href="cleaning-data-i.html#exercise-5"><i class="fa fa-check"></i><b>4.4.1</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="cleaning-data-i.html"><a href="cleaning-data-i.html#the-distinct-function"><i class="fa fa-check"></i><b>4.5</b> The <code>distinct</code> function</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="cleaning-data-i.html"><a href="cleaning-data-i.html#exercise-6"><i class="fa fa-check"></i><b>4.5.1</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="cleaning-data-i.html"><a href="cleaning-data-i.html#the-mutate-function."><i class="fa fa-check"></i><b>4.6</b> The <code>mutate</code> function.</a></li>
<li class="chapter" data-level="4.7" data-path="cleaning-data-i.html"><a href="cleaning-data-i.html#the-summarize-function"><i class="fa fa-check"></i><b>4.7</b> The <code>summarize</code> function</a>
<ul>
<li class="chapter" data-level="4.7.1" data-path="cleaning-data-i.html"><a href="cleaning-data-i.html#exercise-7"><i class="fa fa-check"></i><b>4.7.1</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="4.8" data-path="cleaning-data-i.html"><a href="cleaning-data-i.html#the-group_by-and-summarize-functions"><i class="fa fa-check"></i><b>4.8</b> The <code>group_by</code> and <code>summarize</code> functions</a>
<ul>
<li class="chapter" data-level="4.8.1" data-path="cleaning-data-i.html"><a href="cleaning-data-i.html#exercise-8"><i class="fa fa-check"></i><b>4.8.1</b> Exercise</a></li>
<li class="chapter" data-level="4.8.2" data-path="cleaning-data-i.html"><a href="cleaning-data-i.html#exercise-9"><i class="fa fa-check"></i><b>4.8.2</b> Exercise</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="data-cleaning-ii.html"><a href="data-cleaning-ii.html"><i class="fa fa-check"></i><b>5</b> Data Cleaning II</a>
<ul>
<li class="chapter" data-level="5.1" data-path="data-cleaning-ii.html"><a href="data-cleaning-ii.html#the-count-function"><i class="fa fa-check"></i><b>5.1</b> The <code>count</code> function</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="data-cleaning-ii.html"><a href="data-cleaning-ii.html#exercise-10"><i class="fa fa-check"></i><b>5.1.1</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="data-cleaning-ii.html"><a href="data-cleaning-ii.html#using-the-is.na-function"><i class="fa fa-check"></i><b>5.2</b> Using the <code>is.na</code> function</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="data-cleaning-ii.html"><a href="data-cleaning-ii.html#exercise-11"><i class="fa fa-check"></i><b>5.2.1</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="data-cleaning-ii.html"><a href="data-cleaning-ii.html#the-arrange-function"><i class="fa fa-check"></i><b>5.3</b> The <code>arrange</code> function</a></li>
<li class="chapter" data-level="5.4" data-path="data-cleaning-ii.html"><a href="data-cleaning-ii.html#the-filter-function-with-logicals"><i class="fa fa-check"></i><b>5.4</b> The <code>filter</code> function with logicals</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="data-cleaning-ii.html"><a href="data-cleaning-ii.html#exercise-12"><i class="fa fa-check"></i><b>5.4.1</b> Exercise</a></li>
<li class="chapter" data-level="5.4.2" data-path="data-cleaning-ii.html"><a href="data-cleaning-ii.html#exercise-13"><i class="fa fa-check"></i><b>5.4.2</b> Exercise</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="graphics-with-ggplot2.html"><a href="graphics-with-ggplot2.html"><i class="fa fa-check"></i><b>6</b> Graphics with ggplot2</a>
<ul>
<li class="chapter" data-level="6.1" data-path="graphics-with-ggplot2.html"><a href="graphics-with-ggplot2.html#the-grammar-of-graphics"><i class="fa fa-check"></i><b>6.1</b> The grammar of graphics</a></li>
<li class="chapter" data-level="6.2" data-path="graphics-with-ggplot2.html"><a href="graphics-with-ggplot2.html#adding-options"><i class="fa fa-check"></i><b>6.2</b> Adding options</a></li>
<li class="chapter" data-level="6.3" data-path="graphics-with-ggplot2.html"><a href="graphics-with-ggplot2.html#adding-multiple-plots-together"><i class="fa fa-check"></i><b>6.3</b> Adding multiple plots together</a></li>
<li class="chapter" data-level="6.4" data-path="graphics-with-ggplot2.html"><a href="graphics-with-ggplot2.html#creating-legends"><i class="fa fa-check"></i><b>6.4</b> Creating legends</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="graphics-with-ggplot2.html"><a href="graphics-with-ggplot2.html#exercise-14"><i class="fa fa-check"></i><b>6.4.1</b> Exercise</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="programming.html"><a href="programming.html"><i class="fa fa-check"></i><b>7</b> Programming</a>
<ul>
<li class="chapter" data-level="7.1" data-path="programming.html"><a href="programming.html#functions"><i class="fa fa-check"></i><b>7.1</b> Functions</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="programming.html"><a href="programming.html#exercise-15"><i class="fa fa-check"></i><b>7.1.1</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="programming.html"><a href="programming.html#for-loops"><i class="fa fa-check"></i><b>7.2</b> For-loops</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="programming.html"><a href="programming.html#exercise-16"><i class="fa fa-check"></i><b>7.2.1</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="programming.html"><a href="programming.html#if-else"><i class="fa fa-check"></i><b>7.3</b> If-else</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="programming.html"><a href="programming.html#exercise-17"><i class="fa fa-check"></i><b>7.3.1</b> Exercise</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="relational-data.html"><a href="relational-data.html"><i class="fa fa-check"></i><b>8</b> Relational Data</a>
<ul>
<li class="chapter" data-level="8.1" data-path="relational-data.html"><a href="relational-data.html#finding-primary-keys"><i class="fa fa-check"></i><b>8.1</b> Finding Primary Keys</a></li>
<li class="chapter" data-level="8.2" data-path="relational-data.html"><a href="relational-data.html#finding-primary-keys-harder"><i class="fa fa-check"></i><b>8.2</b> Finding Primary Keys (harder)</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="relational-data.html"><a href="relational-data.html#exercise-18"><i class="fa fa-check"></i><b>8.2.1</b> Exercise</a></li>
<li class="chapter" data-level="8.2.2" data-path="relational-data.html"><a href="relational-data.html#exercise-19"><i class="fa fa-check"></i><b>8.2.2</b> Exercise</a></li>
<li class="chapter" data-level="8.2.3" data-path="relational-data.html"><a href="relational-data.html#exercise-20"><i class="fa fa-check"></i><b>8.2.3</b> Exercise</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="selected-solutions.html"><a href="selected-solutions.html"><i class="fa fa-check"></i><b>9</b> Selected Solutions</a></li>
<li class="divider"></li>
<li><a href="https://bookdown.org" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Guided Exercises: Relational Data</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="relational-data" class="section level1" number="8">
<h1><span class="header-section-number">Chapter 8</span> Relational Data</h1>
<p>For this Guided Exercise, we will be focusing on how to find <em>primary keys</em>. A primary key is a compact way of saying “how to uniquely identify observations in your data set.” To practice finding primary keys, we will be using a variety of data sets that are already preloaded in R packages. The purpose of identifying primary keys is to make merging multiple data sets together easier. Merging data works best when you can merge on keys that uniquely identify your observations. This ensures that each observation is connected to their true data in the foreign data set (i.e. the data set that it will be merged to). A failure to merge your data correctly will result in inaccurate data that will not produce any meaningful result. This is what we want to avoid.</p>
<div id="finding-primary-keys" class="section level2" number="8.1">
<h2><span class="header-section-number">8.1</span> Finding Primary Keys</h2>
<p>The most useful technique to finding primary keys involves a combination of your intuition and the <code>count</code> and <code>filter</code> functions. To start, we’ll load in the <code>titanic_train</code> data from the <code>titanic</code> package.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="relational-data.html#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="do">##loading in the necessary package</span></span>
<span id="cb1-2"><a href="relational-data.html#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-3"><a href="relational-data.html#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(titanic)</span>
<span id="cb1-4"><a href="relational-data.html#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(janitor)</span>
<span id="cb1-5"><a href="relational-data.html#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="do">## data we will be working with  </span></span>
<span id="cb1-6"><a href="relational-data.html#cb1-6" aria-hidden="true" tabindex="-1"></a>titanic <span class="ot">&lt;-</span> <span class="fu">clean_names</span>(titanic_train)</span></code></pre></div>
<p>Let’s take a look at the first few rows of our data by using the <code>head</code> function.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="relational-data.html#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="do">##getting a snapshot of our data</span></span>
<span id="cb2-2"><a href="relational-data.html#cb2-2" aria-hidden="true" tabindex="-1"></a>titanic <span class="sc">%&gt;%</span> </span>
<span id="cb2-3"><a href="relational-data.html#cb2-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>()</span></code></pre></div>
<pre><code>##   passenger_id survived pclass
## 1            1        0      3
## 2            2        1      1
## 3            3        1      3
## 4            4        1      1
## 5            5        0      3
## 6            6        0      3
##                                                  name    sex age sib_sp parch
## 1                             Braund, Mr. Owen Harris   male  22      1     0
## 2 Cumings, Mrs. John Bradley (Florence Briggs Thayer) female  38      1     0
## 3                              Heikkinen, Miss. Laina female  26      0     0
## 4        Futrelle, Mrs. Jacques Heath (Lily May Peel) female  35      1     0
## 5                            Allen, Mr. William Henry   male  35      0     0
## 6                                    Moran, Mr. James   male  NA      0     0
##             ticket    fare cabin embarked
## 1        A/5 21171  7.2500              S
## 2         PC 17599 71.2833   C85        C
## 3 STON/O2. 3101282  7.9250              S
## 4           113803 53.1000  C123        S
## 5           373450  8.0500              S
## 6           330877  8.4583              Q</code></pre>
<p>To uniquely identify an observation, we need a column (or combination of columns) that puts each passenger into one row. In other words, since we have individual-level data, we want to find a row that will uniquely identify each individual. Since this is our first example, this is relatively simple: <code>passenger_id</code> uniquely identifies an individual, and so does <code>name</code>. While this seems intuitive, it is important to actually check whether this is true. This is where the technique of <code>filter</code> and <code>count</code> must be applied.</p>
<p>We will be using the following algorithm to check whether a column (or combination of columns) uniquely identifies our observations:</p>
<ul>
<li>Start with one column that you believe could uniquely identify an observation</li>
<li>Count all of the elements in a column</li>
<li>Filter out any of them that occur more than once</li>
<li>If you do not receive any observation that occur more than once, you are done, if not, you must either try another column, or try a combination of columns. Use your intuition.</li>
</ul>
<p>This small algorithm ensures that we are uniquely identifying each observation. It clearly displays observations that occur more than once to inform us that this column (or columns) does or does not identify a primary key. To summarize, if we run our algorithm and receive any output of observations, we failed to find a primary key and need to rethink how we identify an observation.</p>
<p>Let’s try out this algorithm on our two columns that we intuitively thought could identify each individual.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="relational-data.html#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="do">## using algorithm on the passenger_id column</span></span>
<span id="cb4-2"><a href="relational-data.html#cb4-2" aria-hidden="true" tabindex="-1"></a>titanic <span class="sc">%&gt;%</span> </span>
<span id="cb4-3"><a href="relational-data.html#cb4-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(passenger_id) <span class="sc">%&gt;%</span> </span>
<span id="cb4-4"><a href="relational-data.html#cb4-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(n <span class="sc">&gt;</span><span class="dv">1</span>)</span></code></pre></div>
<pre><code>## [1] passenger_id n           
## &lt;0 rows&gt; (or 0-length row.names)</code></pre>
<p>Success! The <code>passenger_id</code> column does not contain multiple observations of identification. Therefore, it uniquely identifies each observation, and we could use this column to merge in data from other data sets.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="relational-data.html#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="do">## using algorithm on the name column</span></span>
<span id="cb6-2"><a href="relational-data.html#cb6-2" aria-hidden="true" tabindex="-1"></a>titanic <span class="sc">%&gt;%</span> </span>
<span id="cb6-3"><a href="relational-data.html#cb6-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(name) <span class="sc">%&gt;%</span> </span>
<span id="cb6-4"><a href="relational-data.html#cb6-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(n <span class="sc">&gt;</span><span class="dv">1</span>)</span></code></pre></div>
<pre><code>## [1] name n   
## &lt;0 rows&gt; (or 0-length row.names)</code></pre>
<p>Another success! The <code>name</code> column also does not contain multiple observations of any particular name. Therefore, it also identifies each individual, and we could also use this column to merge in data from other data sets.</p>
<p>On the other hand, let’s test the <code>ticket</code> column as it intuitively seems like it could also uniquely identify an observation (there is usually one ticket per person).</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="relational-data.html#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="do">## testing if ticket uniquely identifies</span></span>
<span id="cb8-2"><a href="relational-data.html#cb8-2" aria-hidden="true" tabindex="-1"></a>titanic <span class="sc">%&gt;%</span> </span>
<span id="cb8-3"><a href="relational-data.html#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(ticket) <span class="sc">%&gt;%</span> </span>
<span id="cb8-4"><a href="relational-data.html#cb8-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(n <span class="sc">&gt;</span><span class="dv">1</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb8-5"><a href="relational-data.html#cb8-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>()</span></code></pre></div>
<pre><code>##   ticket n
## 1 110152 3
## 2 110413 3
## 3 110465 2
## 4 111361 2
## 5 113505 2
## 6 113572 2</code></pre>
<p>Clearly, since we see that there are multiple duplicates of ticket numbers, we cannot uniquely identify our observations using the <code>ticket</code> column.</p>
<p>Our <code>titanic</code> dataset is simple in that we have two ways to uniquely identify an observation which only included one column, but this is not always true. In the next section, we will go through a harder example which will require a collection of columns.</p>
</div>
<div id="finding-primary-keys-harder" class="section level2" number="8.2">
<h2><span class="header-section-number">8.2</span> Finding Primary Keys (harder)</h2>
<p>In the <code>titanic</code> example, finding the primary keys was pretty intuitive, and a little trivial. However, this is not always the case. Let’s take a look at a data set from the <code>babynames</code> package. The <code>babynames</code> data set provides data on names given at birth from the Social Security Administration. This includes all names with at least 5 uses (sorry Elon). For our purposes, we will subset the data set since the original data is almost 2 million observations.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="relational-data.html#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="do">## loading the necessary package</span></span>
<span id="cb10-2"><a href="relational-data.html#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(babynames)</span>
<span id="cb10-3"><a href="relational-data.html#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="do">## selecting only the first 20,000 observations and getting rid of one of the rows we don&#39;t need</span></span>
<span id="cb10-4"><a href="relational-data.html#cb10-4" aria-hidden="true" tabindex="-1"></a>babynames <span class="ot">&lt;-</span> babynames[<span class="dv">1</span><span class="sc">:</span><span class="dv">20000</span>,] <span class="sc">%&gt;%</span> </span>
<span id="cb10-5"><a href="relational-data.html#cb10-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>n)</span></code></pre></div>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="relational-data.html#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="do">## getting a preview of the data</span></span>
<span id="cb11-2"><a href="relational-data.html#cb11-2" aria-hidden="true" tabindex="-1"></a>babynames <span class="sc">%&gt;%</span> </span>
<span id="cb11-3"><a href="relational-data.html#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>()</span></code></pre></div>
<pre><code>## # A tibble: 6 × 4
##    year sex   name        prop
##   &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;      &lt;dbl&gt;
## 1  1880 F     Mary      0.0724
## 2  1880 F     Anna      0.0267
## 3  1880 F     Emma      0.0205
## 4  1880 F     Elizabeth 0.0199
## 5  1880 F     Minnie    0.0179
## 6  1880 F     Margaret  0.0162</code></pre>
<p>As we can see, there are four columns:</p>
<ul>
<li><code>year</code>- the year of the birth</li>
<li><code>sex</code> - the sex of the child</li>
<li><code>name</code> - the name of the child</li>
<li><code>prop</code> - a weighting variable we do not care about</li>
</ul>
<p>We want to uniquely identify an observation. This is where we need intuition as well as our algorithm. Would <code>name</code> uniquely identify an observation? No. A name can appear in many different years. Observe our algorithm:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="relational-data.html#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="do">## checking if name uniquely identifies the data </span></span>
<span id="cb13-2"><a href="relational-data.html#cb13-2" aria-hidden="true" tabindex="-1"></a>babynames <span class="sc">%&gt;%</span> </span>
<span id="cb13-3"><a href="relational-data.html#cb13-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(name) <span class="sc">%&gt;%</span> </span>
<span id="cb13-4"><a href="relational-data.html#cb13-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(n <span class="sc">&gt;</span><span class="dv">1</span>)</span></code></pre></div>
<pre><code>## # A tibble: 2,728 × 2
##    name        n
##    &lt;chr&gt;   &lt;int&gt;
##  1 Aaron       9
##  2 Ab          4
##  3 Abbie      10
##  4 Abbott      2
##  5 Abby        8
##  6 Abe         9
##  7 Abel        9
##  8 Abigail     9
##  9 Abner       9
## 10 Abraham     9
## # … with 2,718 more rows</code></pre>
<p>Clearly, we see that there are multiple times a name appears. Hence, we must use a <em>collection</em> of columns to uniquely identify (recall our algorithm).</p>
<p>Our intuition should tell us that using <code>name</code> and <code>year</code> may allow us to uniquely identify our data since each name likely occurs one time within each year. As always, our algorithm can check this assumption:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="relational-data.html#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="do">## checking if name and year uniquely identifies the data</span></span>
<span id="cb15-2"><a href="relational-data.html#cb15-2" aria-hidden="true" tabindex="-1"></a>babynames <span class="sc">%&gt;%</span> </span>
<span id="cb15-3"><a href="relational-data.html#cb15-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(name, year) <span class="sc">%&gt;%</span> </span>
<span id="cb15-4"><a href="relational-data.html#cb15-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(n<span class="sc">&gt;</span><span class="dv">1</span>)</span></code></pre></div>
<pre><code>## # A tibble: 1,245 × 3
##    name   year     n
##    &lt;chr&gt; &lt;dbl&gt; &lt;int&gt;
##  1 Abbie  1887     2
##  2 Ada    1885     2
##  3 Ada    1886     2
##  4 Ada    1887     2
##  5 Addie  1880     2
##  6 Addie  1881     2
##  7 Addie  1882     2
##  8 Addie  1883     2
##  9 Addie  1884     2
## 10 Addie  1886     2
## # … with 1,235 more rows</code></pre>
<p>It seems we are still not getting unique observations as there are many names that appear twice. Why would this be? This is where you must think critically about your data. Notice that our algorithm has shown us that names occur a maximum of two times. This should hint at something: <em>these names are being used for both males and females</em>. Therefore, to uniquely identify an observation, we must use <em>three</em> columns: <code>name</code>, <code>year</code>, and <code>sex</code>.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="relational-data.html#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="do">## checking if name, year, and sex uniquely identify an observation</span></span>
<span id="cb17-2"><a href="relational-data.html#cb17-2" aria-hidden="true" tabindex="-1"></a>babynames <span class="sc">%&gt;%</span> </span>
<span id="cb17-3"><a href="relational-data.html#cb17-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(name, year, sex) <span class="sc">%&gt;%</span> </span>
<span id="cb17-4"><a href="relational-data.html#cb17-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(n <span class="sc">&gt;</span> <span class="dv">1</span>)</span></code></pre></div>
<pre><code>## # A tibble: 0 × 4
## # … with 4 variables: name &lt;chr&gt;, year &lt;dbl&gt;, sex &lt;chr&gt;, n &lt;int&gt;</code></pre>
<p>Success! We managed to find a grouping of columns that brought each observation to one entry. Hence, if we were merging in data, we would want to use these three columns to connect the data.</p>
<div id="exercise-18" class="section level3" number="8.2.1">
<h3><span class="header-section-number">8.2.1</span> Exercise</h3>
<ul>
<li>(Taken from R for Data Science Chapter 13.3 Exercises) Identify the primary key in the following data set from the <code>fueleconomy</code> package: <code>vehicles</code>. Remember, the primary key could be a single column or a collection of columns.</li>
</ul>
</div>
<div id="exercise-19" class="section level3" number="8.2.2">
<h3><span class="header-section-number">8.2.2</span> Exercise</h3>
<ul>
<li>(Taken from R for Data Science Chapter 13.3 Exercises) Identify the primary key in the following data set from the <code>Lahman</code> package: <code>Batting</code>. Remember, the primary key could be a single column or a collection of columns.</li>
</ul>
</div>
<div id="exercise-20" class="section level3" number="8.2.3">
<h3><span class="header-section-number">8.2.3</span> Exercise</h3>
<ul>
<li>(Taken from R for Data Science Chapter 13.3 Exercises) Identify the primary key in the following data set from the <code>nasaweather</code> package: <code>atmos</code>. Remember, the primary key could be a single column or a collection of columns.</li>
</ul>
</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="programming.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="selected-solutions.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/jules32/bookdown-tutorial/edit/master/relational_data.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["series.pdf"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
