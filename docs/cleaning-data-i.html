<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 5 Cleaning Data I | Data Wrangling for Economists</title>
  <meta name="description" content="Enter description." />
  <meta name="generator" content="bookdown 0.22 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 5 Cleaning Data I | Data Wrangling for Economists" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Enter description." />
  <meta name="github-repo" content="openscapes/series" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 5 Cleaning Data I | Data Wrangling for Economists" />
  
  <meta name="twitter:description" content="Enter description." />
  

<meta name="author" content="Michael Topper" />
<meta name="author" content="Danny Klinenberg" />


<meta name="date" content="2021-09-03" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="git-and-github.html"/>
<link rel="next" href="data-cleaning-ii.html"/>
<script src="libs/header-attrs-2.9/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.5.3/htmlwidgets.js"></script>
<link href="libs/str_view-0.1.0/str_view.css" rel="stylesheet" />
<script src="libs/str_view-binding-1.4.0/str_view.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="lib/css/bootstrap.min.css" type="text/css" />
<link rel="stylesheet" href="lib/css/style.css" type="text/css" />
<link rel="stylesheet" href="lib/css/lesson.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Data Wrangling for Economists</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Welcome</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#organization"><i class="fa fa-check"></i><b>1.1</b> Organization</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="intro-to-r.html"><a href="intro-to-r.html"><i class="fa fa-check"></i><b>2</b> Intro to R</a>
<ul>
<li class="chapter" data-level="2.1" data-path="intro-to-r.html"><a href="intro-to-r.html#basic-summary-statistics"><i class="fa fa-check"></i><b>2.1</b> Basic summary statistics</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="intro-to-r.html"><a href="intro-to-r.html#exercise"><i class="fa fa-check"></i><b>2.1.1</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="intro-to-r.html"><a href="intro-to-r.html#basic-histogram"><i class="fa fa-check"></i><b>2.2</b> Basic histogram</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="intro-to-r.html"><a href="intro-to-r.html#exercise-1"><i class="fa fa-check"></i><b>2.2.1</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="intro-to-r.html"><a href="intro-to-r.html#creating-vectors"><i class="fa fa-check"></i><b>2.3</b> Creating Vectors</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="intro-to-r.html"><a href="intro-to-r.html#exercise-2"><i class="fa fa-check"></i><b>2.3.1</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="intro-to-r.html"><a href="intro-to-r.html#comparing-vectors"><i class="fa fa-check"></i><b>2.4</b> Comparing Vectors</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="intro-to-r.html"><a href="intro-to-r.html#exercise-3"><i class="fa fa-check"></i><b>2.4.1</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="intro-to-r.html"><a href="intro-to-r.html#creating-a-tibble"><i class="fa fa-check"></i><b>2.5</b> Creating a tibble</a></li>
<li class="chapter" data-level="2.6" data-path="intro-to-r.html"><a href="intro-to-r.html#exercise-4"><i class="fa fa-check"></i><b>2.6</b> Exercise</a></li>
<li class="chapter" data-level="2.7" data-path="intro-to-r.html"><a href="intro-to-r.html#selected-solutions"><i class="fa fa-check"></i><b>2.7</b> Selected Solutions</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="the-rproject.html"><a href="the-rproject.html"><i class="fa fa-check"></i><b>3</b> The <code>Rproject</code></a></li>
<li class="chapter" data-level="4" data-path="git-and-github.html"><a href="git-and-github.html"><i class="fa fa-check"></i><b>4</b> Git and Github</a>
<ul>
<li class="chapter" data-level="4.1" data-path="git-and-github.html"><a href="git-and-github.html#installing-git"><i class="fa fa-check"></i><b>4.1</b> Installing Git</a></li>
<li class="chapter" data-level="4.2" data-path="git-and-github.html"><a href="git-and-github.html#create-a-github-account"><i class="fa fa-check"></i><b>4.2</b> Create a Github account</a></li>
<li class="chapter" data-level="4.3" data-path="git-and-github.html"><a href="git-and-github.html#introduce-yourself-to-git"><i class="fa fa-check"></i><b>4.3</b> Introduce yourself to Git</a></li>
<li class="chapter" data-level="4.4" data-path="git-and-github.html"><a href="git-and-github.html#create-a-pat"><i class="fa fa-check"></i><b>4.4</b> Create a PAT</a></li>
<li class="chapter" data-level="4.5" data-path="git-and-github.html"><a href="git-and-github.html#the-workflow"><i class="fa fa-check"></i><b>4.5</b> The Workflow</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="git-and-github.html"><a href="git-and-github.html#definitions"><i class="fa fa-check"></i><b>4.5.1</b> Definitions</a></li>
<li class="chapter" data-level="4.5.2" data-path="git-and-github.html"><a href="git-and-github.html#the-workflow-1"><i class="fa fa-check"></i><b>4.5.2</b> The Workflow</a></li>
<li class="chapter" data-level="4.5.3" data-path="git-and-github.html"><a href="git-and-github.html#the-git-panel-of-rstudio"><i class="fa fa-check"></i><b>4.5.3</b> The Git panel of RStudio</a></li>
<li class="chapter" data-level="4.5.4" data-path="git-and-github.html"><a href="git-and-github.html#pulling"><i class="fa fa-check"></i><b>4.5.4</b> Pulling</a></li>
<li class="chapter" data-level="4.5.5" data-path="git-and-github.html"><a href="git-and-github.html#commiting"><i class="fa fa-check"></i><b>4.5.5</b> Commiting</a></li>
<li class="chapter" data-level="4.5.6" data-path="git-and-github.html"><a href="git-and-github.html#pushing"><i class="fa fa-check"></i><b>4.5.6</b> Pushing</a></li>
<li class="chapter" data-level="4.5.7" data-path="git-and-github.html"><a href="git-and-github.html#pulling-again"><i class="fa fa-check"></i><b>4.5.7</b> Pulling (again)</a></li>
<li class="chapter" data-level="4.5.8" data-path="git-and-github.html"><a href="git-and-github.html#the-main-commands-command-lineterminal"><i class="fa fa-check"></i><b>4.5.8</b> The Main Commands (Command Line/Terminal)</a></li>
<li class="chapter" data-level="4.5.9" data-path="git-and-github.html"><a href="git-and-github.html#exercise-5"><i class="fa fa-check"></i><b>4.5.9</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="git-and-github.html"><a href="git-and-github.html#branches"><i class="fa fa-check"></i><b>4.6</b> Branches</a>
<ul>
<li class="chapter" data-level="4.6.1" data-path="git-and-github.html"><a href="git-and-github.html#creating-a-branch"><i class="fa fa-check"></i><b>4.6.1</b> Creating a branch</a></li>
<li class="chapter" data-level="4.6.2" data-path="git-and-github.html"><a href="git-and-github.html#branches-when-working-independently"><i class="fa fa-check"></i><b>4.6.2</b> Branches when working independently</a></li>
<li class="chapter" data-level="4.6.3" data-path="git-and-github.html"><a href="git-and-github.html#branches-when-working-collaboratively"><i class="fa fa-check"></i><b>4.6.3</b> Branches when working collaboratively</a></li>
<li class="chapter" data-level="4.6.4" data-path="git-and-github.html"><a href="git-and-github.html#branches-with-the-terminal"><i class="fa fa-check"></i><b>4.6.4</b> Branches with the Terminal</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="git-and-github.html"><a href="git-and-github.html#gitignore"><i class="fa fa-check"></i><b>4.7</b> .gitignore</a></li>
<li class="chapter" data-level="4.8" data-path="git-and-github.html"><a href="git-and-github.html#reverting"><i class="fa fa-check"></i><b>4.8</b> Reverting</a>
<ul>
<li class="chapter" data-level="4.8.1" data-path="git-and-github.html"><a href="git-and-github.html#reverting-safelty"><i class="fa fa-check"></i><b>4.8.1</b> Reverting Safelty</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="cleaning-data-i.html"><a href="cleaning-data-i.html"><i class="fa fa-check"></i><b>5</b> Cleaning Data I</a>
<ul>
<li class="chapter" data-level="5.1" data-path="cleaning-data-i.html"><a href="cleaning-data-i.html#the-pipe"><i class="fa fa-check"></i><b>5.1</b> The Pipe</a></li>
<li class="chapter" data-level="5.2" data-path="cleaning-data-i.html"><a href="cleaning-data-i.html#the-clean_names-function"><i class="fa fa-check"></i><b>5.2</b> The <code>clean_names</code> function</a></li>
<li class="chapter" data-level="5.3" data-path="cleaning-data-i.html"><a href="cleaning-data-i.html#the-select-function"><i class="fa fa-check"></i><b>5.3</b> The <code>select</code> function</a></li>
<li class="chapter" data-level="5.4" data-path="cleaning-data-i.html"><a href="cleaning-data-i.html#the-filter-function"><i class="fa fa-check"></i><b>5.4</b> The <code>filter</code> function</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="cleaning-data-i.html"><a href="cleaning-data-i.html#exercise-6"><i class="fa fa-check"></i><b>5.4.1</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="cleaning-data-i.html"><a href="cleaning-data-i.html#the-distinct-function"><i class="fa fa-check"></i><b>5.5</b> The <code>distinct</code> function</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="cleaning-data-i.html"><a href="cleaning-data-i.html#exercise-7"><i class="fa fa-check"></i><b>5.5.1</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="cleaning-data-i.html"><a href="cleaning-data-i.html#the-mutate-function."><i class="fa fa-check"></i><b>5.6</b> The <code>mutate</code> function.</a></li>
<li class="chapter" data-level="5.7" data-path="cleaning-data-i.html"><a href="cleaning-data-i.html#the-summarize-function"><i class="fa fa-check"></i><b>5.7</b> The <code>summarize</code> function</a>
<ul>
<li class="chapter" data-level="5.7.1" data-path="cleaning-data-i.html"><a href="cleaning-data-i.html#exercise-8"><i class="fa fa-check"></i><b>5.7.1</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="5.8" data-path="cleaning-data-i.html"><a href="cleaning-data-i.html#the-group_by-and-summarize-functions"><i class="fa fa-check"></i><b>5.8</b> The <code>group_by</code> and <code>summarize</code> functions</a></li>
<li class="chapter" data-level="5.9" data-path="cleaning-data-i.html"><a href="cleaning-data-i.html#exercise-9"><i class="fa fa-check"></i><b>5.9</b> Exercise</a>
<ul>
<li class="chapter" data-level="5.9.1" data-path="cleaning-data-i.html"><a href="cleaning-data-i.html#exercise-10"><i class="fa fa-check"></i><b>5.9.1</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="5.10" data-path="cleaning-data-i.html"><a href="cleaning-data-i.html#selected-solutions-1"><i class="fa fa-check"></i><b>5.10</b> Selected Solutions</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="data-cleaning-ii.html"><a href="data-cleaning-ii.html"><i class="fa fa-check"></i><b>6</b> Data Cleaning II</a>
<ul>
<li class="chapter" data-level="6.1" data-path="data-cleaning-ii.html"><a href="data-cleaning-ii.html#the-count-function"><i class="fa fa-check"></i><b>6.1</b> The <code>count</code> function</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="data-cleaning-ii.html"><a href="data-cleaning-ii.html#exercise-11"><i class="fa fa-check"></i><b>6.1.1</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="data-cleaning-ii.html"><a href="data-cleaning-ii.html#using-the-is.na-function"><i class="fa fa-check"></i><b>6.2</b> Using the <code>is.na</code> function</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="data-cleaning-ii.html"><a href="data-cleaning-ii.html#exercise-12"><i class="fa fa-check"></i><b>6.2.1</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="data-cleaning-ii.html"><a href="data-cleaning-ii.html#the-arrange-function"><i class="fa fa-check"></i><b>6.3</b> The <code>arrange</code> function</a></li>
<li class="chapter" data-level="6.4" data-path="data-cleaning-ii.html"><a href="data-cleaning-ii.html#the-filter-function-with-logicals"><i class="fa fa-check"></i><b>6.4</b> The <code>filter</code> function with logicals</a></li>
<li class="chapter" data-level="6.5" data-path="data-cleaning-ii.html"><a href="data-cleaning-ii.html#exercise-13"><i class="fa fa-check"></i><b>6.5</b> Exercise</a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="data-cleaning-ii.html"><a href="data-cleaning-ii.html#exercise-14"><i class="fa fa-check"></i><b>6.5.1</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="data-cleaning-ii.html"><a href="data-cleaning-ii.html#selected-solutions-2"><i class="fa fa-check"></i><b>6.6</b> Selected Solutions</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="graphics-with-ggplot2.html"><a href="graphics-with-ggplot2.html"><i class="fa fa-check"></i><b>7</b> Graphics with ggplot2</a>
<ul>
<li class="chapter" data-level="7.1" data-path="graphics-with-ggplot2.html"><a href="graphics-with-ggplot2.html#the-grammar-of-graphics"><i class="fa fa-check"></i><b>7.1</b> The grammar of graphics</a></li>
<li class="chapter" data-level="7.2" data-path="graphics-with-ggplot2.html"><a href="graphics-with-ggplot2.html#adding-options"><i class="fa fa-check"></i><b>7.2</b> Adding options</a></li>
<li class="chapter" data-level="7.3" data-path="graphics-with-ggplot2.html"><a href="graphics-with-ggplot2.html#adding-multiple-plots-together"><i class="fa fa-check"></i><b>7.3</b> Adding multiple plots together</a></li>
<li class="chapter" data-level="7.4" data-path="graphics-with-ggplot2.html"><a href="graphics-with-ggplot2.html#creating-legends"><i class="fa fa-check"></i><b>7.4</b> Creating legends</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="graphics-with-ggplot2.html"><a href="graphics-with-ggplot2.html#exercise-15"><i class="fa fa-check"></i><b>7.4.1</b> Exercise</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="strings.html"><a href="strings.html"><i class="fa fa-check"></i><b>8</b> Strings</a>
<ul>
<li class="chapter" data-level="8.1" data-path="strings.html"><a href="strings.html#regular-expressions"><i class="fa fa-check"></i><b>8.1</b> Regular Expressions</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="strings.html"><a href="strings.html#exercise-1-1"><i class="fa fa-check"></i><b>8.1.1</b> Exercise 1</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="strings.html"><a href="strings.html#regular-expressions-continued"><i class="fa fa-check"></i><b>8.2</b> Regular Expressions Continued</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="strings.html"><a href="strings.html#exercise-2-1"><i class="fa fa-check"></i><b>8.2.1</b> Exercise 2</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="strings.html"><a href="strings.html#using-extract"><i class="fa fa-check"></i><b>8.3</b> Using <code>extract</code></a></li>
<li class="chapter" data-level="8.4" data-path="strings.html"><a href="strings.html#using-separate"><i class="fa fa-check"></i><b>8.4</b> Using <code>separate</code></a></li>
<li class="chapter" data-level="8.5" data-path="strings.html"><a href="strings.html#the-gsub-function"><i class="fa fa-check"></i><b>8.5</b> The <code>gsub</code> function</a>
<ul>
<li class="chapter" data-level="8.5.1" data-path="strings.html"><a href="strings.html#exercise-3-1"><i class="fa fa-check"></i><b>8.5.1</b> Exercise 3</a></li>
</ul></li>
<li class="chapter" data-level="8.6" data-path="strings.html"><a href="strings.html#solutions"><i class="fa fa-check"></i><b>8.6</b> Solutions</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="file-organization.html"><a href="file-organization.html"><i class="fa fa-check"></i><b>9</b> File Organization</a>
<ul>
<li class="chapter" data-level="9.1" data-path="file-organization.html"><a href="file-organization.html#organizing"><i class="fa fa-check"></i><b>9.1</b> Organizing</a></li>
<li class="chapter" data-level="9.2" data-path="file-organization.html"><a href="file-organization.html#rmarkdown"><i class="fa fa-check"></i><b>9.2</b> <code>Rmarkdown</code></a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="file-organization.html"><a href="file-organization.html#the-anatomy-of-an-rmarkdown-file"><i class="fa fa-check"></i><b>9.2.1</b> The Anatomy of an <code>Rmarkdown</code> File</a></li>
<li class="chapter" data-level="9.2.2" data-path="file-organization.html"><a href="file-organization.html#the-body-of-the-rmarkdown"><i class="fa fa-check"></i><b>9.2.2</b> The Body of the <code>Rmarkdown</code></a></li>
<li class="chapter" data-level="9.2.3" data-path="file-organization.html"><a href="file-organization.html#childing"><i class="fa fa-check"></i><b>9.2.3</b> Childing</a></li>
<li class="chapter" data-level="9.2.4" data-path="file-organization.html"><a href="file-organization.html#bibliographies"><i class="fa fa-check"></i><b>9.2.4</b> Bibliographies</a></li>
<li class="chapter" data-level="9.2.5" data-path="file-organization.html"><a href="file-organization.html#a-final-note-on-rmarkdown-visual-markdown-editor"><i class="fa fa-check"></i><b>9.2.5</b> A Final Note on <code>Rmarkdown</code>: Visual Markdown Editor</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="programming.html"><a href="programming.html"><i class="fa fa-check"></i><b>10</b> Programming</a>
<ul>
<li class="chapter" data-level="10.1" data-path="programming.html"><a href="programming.html#functions"><i class="fa fa-check"></i><b>10.1</b> Functions</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="programming.html"><a href="programming.html#exercise-16"><i class="fa fa-check"></i><b>10.1.1</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="programming.html"><a href="programming.html#for-loops"><i class="fa fa-check"></i><b>10.2</b> For-loops</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="programming.html"><a href="programming.html#exercise-17"><i class="fa fa-check"></i><b>10.2.1</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="programming.html"><a href="programming.html#if-else"><i class="fa fa-check"></i><b>10.3</b> If-else</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="programming.html"><a href="programming.html#exercise-18"><i class="fa fa-check"></i><b>10.3.1</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="programming.html"><a href="programming.html#selected-solutions-3"><i class="fa fa-check"></i><b>10.4</b> Selected Solutions</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="relational-data.html"><a href="relational-data.html"><i class="fa fa-check"></i><b>11</b> Relational Data</a>
<ul>
<li class="chapter" data-level="11.1" data-path="relational-data.html"><a href="relational-data.html#finding-primary-keys"><i class="fa fa-check"></i><b>11.1</b> Finding Primary Keys</a></li>
<li class="chapter" data-level="11.2" data-path="relational-data.html"><a href="relational-data.html#finding-primary-keys-harder"><i class="fa fa-check"></i><b>11.2</b> Finding Primary Keys (harder)</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="relational-data.html"><a href="relational-data.html#exercise-19"><i class="fa fa-check"></i><b>11.2.1</b> Exercise</a></li>
<li class="chapter" data-level="11.2.2" data-path="relational-data.html"><a href="relational-data.html#exercise-20"><i class="fa fa-check"></i><b>11.2.2</b> Exercise</a></li>
<li class="chapter" data-level="11.2.3" data-path="relational-data.html"><a href="relational-data.html#exercise-21"><i class="fa fa-check"></i><b>11.2.3</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="relational-data.html"><a href="relational-data.html#selected-solutions-4"><i class="fa fa-check"></i><b>11.3</b> Selected Solutions</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://bookdown.org" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Data Wrangling for Economists</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="cleaning-data-i" class="section level1" number="5">
<h1><span class="header-section-number">Chapter 5</span> Cleaning Data I</h1>
<p>For this chapter, we will once again be working with the <code>titanic_train</code> data set from the <code>titanic</code> package. This data set provides information on the fate of passengers on the fatal maiden voyage of the ocean liner “Titanic” summarized according to economic status (class), sex, age, and survival. As a reminder, here are some of the important columns:</p>
<ul>
<li><code>Survived</code>: binary variable equal to 1 if the passenger survived</li>
<li><code>Pclass</code>: the passenger’s class</li>
<li><code>Name</code>: the passenger’s name</li>
<li><code>Sex</code>: the sex of the passenger</li>
<li><code>Age</code>: the age of the passenger</li>
</ul>
<p>Now let’s load in the data and necessary packages.</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="cleaning-data-i.html#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="do">## install the package if you do not have it</span></span>
<span id="cb59-2"><a href="cleaning-data-i.html#cb59-2" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages(&quot;titanic&quot;)</span></span>
<span id="cb59-3"><a href="cleaning-data-i.html#cb59-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(titanic)</span>
<span id="cb59-4"><a href="cleaning-data-i.html#cb59-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb59-5"><a href="cleaning-data-i.html#cb59-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(janitor)</span>
<span id="cb59-6"><a href="cleaning-data-i.html#cb59-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-7"><a href="cleaning-data-i.html#cb59-7" aria-hidden="true" tabindex="-1"></a><span class="do">## saving our data to the name titanic as a tibble</span></span>
<span id="cb59-8"><a href="cleaning-data-i.html#cb59-8" aria-hidden="true" tabindex="-1"></a>titanic <span class="ot">&lt;-</span> <span class="fu">tibble</span>(titanic_train)</span></code></pre></div>
<p>We will be focusing on getting comfortable with the following functions in the <code>tidyverse</code> package:</p>
<ul>
<li><code>select</code></li>
<li><code>distinct</code></li>
<li><code>mutate</code></li>
<li><code>group_by</code></li>
<li><code>summarize</code></li>
</ul>
<p>We will also learn how to use the following functions in the <code>janitor</code> package:</p>
<ul>
<li><code>clean_names</code></li>
</ul>
<p>We will be using these functions in conjunction with the pipe (typed as <code>%&gt;%</code>) operator. By going through these exercises, you will see proper ways to utilize functions and learn to write code in a readable and reproducible way.</p>
<div id="the-pipe" class="section level2" number="5.1">
<h2><span class="header-section-number">5.1</span> The Pipe</h2>
<p>A pipe (typed as <code>%&gt;%</code>) is a specific operator that comes from the <code>magrittr</code> package, but is automatically loaded in with the <code>tidyverse</code>. Essentially, it makes reading code easier, typing code faster, and finding complicated results very easy. A pipe essentially is saying “and now, do this” to a tibble. Piping is best used to chain together multiple functions to subset your data set into smaller pieces that you find more interesting. We will see this pipe in action in the following sections. Mastering the pipe is essential to quick and efficient cleaning, and you can find some incredible results with using pipes and a few simple functions. To demonstrate how a pipe works, I’ll use a rather bland motivating example: suppose we want to glance at our <code>titanic</code> data using the <code>head</code> function. Before the pipe existed, we would need to type the following:</p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="cleaning-data-i.html#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="do">## without a pipe</span></span>
<span id="cb60-2"><a href="cleaning-data-i.html#cb60-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(titanic)</span></code></pre></div>
<p>However, with a pipe, we can type the following:</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="cleaning-data-i.html#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="do">## using a pipe</span></span>
<span id="cb61-2"><a href="cleaning-data-i.html#cb61-2" aria-hidden="true" tabindex="-1"></a>titanic <span class="sc">%&gt;%</span> </span>
<span id="cb61-3"><a href="cleaning-data-i.html#cb61-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>()</span></code></pre></div>
<p>Each of these give us the same result. The way the pipe works, is that it automatically fills the “data” argument of a function with the tibble you are piping from (in this case, the <code>titanic</code> tibble). While this seems extraneous in this example, the benefit of the pipe is that you can combine multiple functions together in a readable way. We will see a demonstration of this as we get further into this Guided Exercise.</p>
</div>
<div id="the-clean_names-function" class="section level2" number="5.2">
<h2><span class="header-section-number">5.2</span> The <code>clean_names</code> function</h2>
<p>The <code>clean_names</code> function allows us to put all of our column names in our tibble in a standardized format. In particular, the function makes certain that the column names are all lowercase and blank spaces are replaced with an underscore. Keeping your variable names standardized is an important practice that will make data wrangling much easier as your data sets get bigger and you begin collaborating with others.</p>
<p>Let’s take a look at our data set without cleaning the names.</p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="cleaning-data-i.html#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="do">## viewing a snapshot of our data set</span></span>
<span id="cb62-2"><a href="cleaning-data-i.html#cb62-2" aria-hidden="true" tabindex="-1"></a>titanic <span class="sc">%&gt;%</span> </span>
<span id="cb62-3"><a href="cleaning-data-i.html#cb62-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>()</span></code></pre></div>
<pre><code>## # A tibble: 6 × 12
##   PassengerId Survived Pclass Name    Sex     Age SibSp Parch Ticket  Fare Cabin
##         &lt;int&gt;    &lt;int&gt;  &lt;int&gt; &lt;chr&gt;   &lt;chr&gt; &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt;  &lt;dbl&gt; &lt;chr&gt;
## 1           1        0      3 Braund… male     22     1     0 A/5 2…  7.25 &quot;&quot;   
## 2           2        1      1 Cuming… fema…    38     1     0 PC 17… 71.3  &quot;C85&quot;
## 3           3        1      3 Heikki… fema…    26     0     0 STON/…  7.92 &quot;&quot;   
## 4           4        1      1 Futrel… fema…    35     1     0 113803 53.1  &quot;C12…
## 5           5        0      3 Allen,… male     35     0     0 373450  8.05 &quot;&quot;   
## 6           6        0      3 Moran,… male     NA     0     0 330877  8.46 &quot;&quot;   
## # … with 1 more variable: Embarked &lt;chr&gt;</code></pre>
<p>Notice here we used the pipe. The pipe told us to take the <code>titanic</code> data set, and perform the <code>head</code> function to it. In terms of piping language we could specify what happened:</p>
<ul>
<li>Use titanic data set</li>
<li>And now take the <code>head</code> of the titanic data set</li>
</ul>
<p>Another important aspect of this output to notice is that our columns begin with capital letters (e.g. <code>Class</code>). As stated, we can use the <code>clean_names</code> function from the janitor package to standardize the column name format to all lower case and underscores. Observe:</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="cleaning-data-i.html#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Using the clean_names function on the titanic data</span></span>
<span id="cb64-2"><a href="cleaning-data-i.html#cb64-2" aria-hidden="true" tabindex="-1"></a>titanic <span class="sc">%&gt;%</span> </span>
<span id="cb64-3"><a href="cleaning-data-i.html#cb64-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">clean_names</span>()</span></code></pre></div>
<p>The column names now all have our desired standardized format. Now let’s try to use our previous <code>head</code> function:</p>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="cleaning-data-i.html#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Using the head function again</span></span>
<span id="cb65-2"><a href="cleaning-data-i.html#cb65-2" aria-hidden="true" tabindex="-1"></a>titanic <span class="sc">%&gt;%</span> </span>
<span id="cb65-3"><a href="cleaning-data-i.html#cb65-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>()</span></code></pre></div>
<pre><code>## # A tibble: 6 × 12
##   PassengerId Survived Pclass Name    Sex     Age SibSp Parch Ticket  Fare Cabin
##         &lt;int&gt;    &lt;int&gt;  &lt;int&gt; &lt;chr&gt;   &lt;chr&gt; &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt;  &lt;dbl&gt; &lt;chr&gt;
## 1           1        0      3 Braund… male     22     1     0 A/5 2…  7.25 &quot;&quot;   
## 2           2        1      1 Cuming… fema…    38     1     0 PC 17… 71.3  &quot;C85&quot;
## 3           3        1      3 Heikki… fema…    26     0     0 STON/…  7.92 &quot;&quot;   
## 4           4        1      1 Futrel… fema…    35     1     0 113803 53.1  &quot;C12…
## 5           5        0      3 Allen,… male     35     0     0 373450  8.05 &quot;&quot;   
## 6           6        0      3 Moran,… male     NA     0     0 330877  8.46 &quot;&quot;   
## # … with 1 more variable: Embarked &lt;chr&gt;</code></pre>
<p>The columns have gone back to their normal messy ways! This is because <strong>we failed to save the changes we made</strong> to our titanic data set. The pipe operator will perform functions on your tibble, but it will <strong>not</strong> save the changes unless you explicitly tell R to do so.</p>
<p>Let’s use the <code>clean_names</code> function, and save the tibble with the cleaned column names.</p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="cleaning-data-i.html#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="do">## saving the titanic tibble with cleaned names</span></span>
<span id="cb67-2"><a href="cleaning-data-i.html#cb67-2" aria-hidden="true" tabindex="-1"></a>titanic <span class="ot">&lt;-</span> titanic <span class="sc">%&gt;%</span> </span>
<span id="cb67-3"><a href="cleaning-data-i.html#cb67-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">clean_names</span>()</span>
<span id="cb67-4"><a href="cleaning-data-i.html#cb67-4" aria-hidden="true" tabindex="-1"></a><span class="do">## viewing the cleaned names data set as it has now been saved</span></span>
<span id="cb67-5"><a href="cleaning-data-i.html#cb67-5" aria-hidden="true" tabindex="-1"></a>titanic <span class="sc">%&gt;%</span> </span>
<span id="cb67-6"><a href="cleaning-data-i.html#cb67-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>()</span></code></pre></div>
<pre><code>## # A tibble: 6 × 12
##   passenger_id survived pclass name  sex     age sib_sp parch ticket  fare cabin
##          &lt;int&gt;    &lt;int&gt;  &lt;int&gt; &lt;chr&gt; &lt;chr&gt; &lt;dbl&gt;  &lt;int&gt; &lt;int&gt; &lt;chr&gt;  &lt;dbl&gt; &lt;chr&gt;
## 1            1        0      3 Brau… male     22      1     0 A/5 2…  7.25 &quot;&quot;   
## 2            2        1      1 Cumi… fema…    38      1     0 PC 17… 71.3  &quot;C85&quot;
## 3            3        1      3 Heik… fema…    26      0     0 STON/…  7.92 &quot;&quot;   
## 4            4        1      1 Futr… fema…    35      1     0 113803 53.1  &quot;C12…
## 5            5        0      3 Alle… male     35      0     0 373450  8.05 &quot;&quot;   
## 6            6        0      3 Mora… male     NA      0     0 330877  8.46 &quot;&quot;   
## # … with 1 more variable: embarked &lt;chr&gt;</code></pre>
<p>For the rest of this guided exercise, we will be working with this tibble.</p>
</div>
<div id="the-select-function" class="section level2" number="5.3">
<h2><span class="header-section-number">5.3</span> The <code>select</code> function</h2>
<p>The <code>select</code> function is a way to subset your data. It selects whichever variables you are particularly concerned with. For instance, suppose we were only interested in the <code>age</code> and <code>survived</code> columns of the <code>titanic</code> tibble. We could use the <code>select</code> function to observe only these columns.</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="cleaning-data-i.html#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="do">## selecting only the age and survived columns and then previewing with head</span></span>
<span id="cb69-2"><a href="cleaning-data-i.html#cb69-2" aria-hidden="true" tabindex="-1"></a>titanic <span class="sc">%&gt;%</span> </span>
<span id="cb69-3"><a href="cleaning-data-i.html#cb69-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(age, survived) <span class="sc">%&gt;%</span> </span>
<span id="cb69-4"><a href="cleaning-data-i.html#cb69-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>()</span></code></pre></div>
<pre><code>## # A tibble: 6 × 2
##     age survived
##   &lt;dbl&gt;    &lt;int&gt;
## 1    22        0
## 2    38        1
## 3    26        1
## 4    35        1
## 5    35        0
## 6    NA        0</code></pre>
<p>There are a few things that should be noted here. First, we did not save this sub-selection of variables as a new tibble, so this is just a temporary sub-selection. Second, we performed two pipes with one pipe on each line until the ending function. This code could be read as:</p>
<ul>
<li>Use the <code>titanic</code> tibble</li>
<li>And then <code>select</code> the <code>age</code> and <code>survived</code> columns</li>
<li>And then use the <code>head</code> function to view</li>
</ul>
<p>Of course, if we wanted to save our sub-selection, we could easily do this by assigning it to a new tibble.</p>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="cleaning-data-i.html#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="do">## assigning the subselection to a new tibble</span></span>
<span id="cb71-2"><a href="cleaning-data-i.html#cb71-2" aria-hidden="true" tabindex="-1"></a>titanic_age_survived <span class="ot">&lt;-</span> titanic <span class="sc">%&gt;%</span> </span>
<span id="cb71-3"><a href="cleaning-data-i.html#cb71-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(age, survived)</span>
<span id="cb71-4"><a href="cleaning-data-i.html#cb71-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-5"><a href="cleaning-data-i.html#cb71-5" aria-hidden="true" tabindex="-1"></a><span class="do">## did not use head here because do not want only the first 5 rows to be saved</span></span></code></pre></div>
<p>Generally, the <code>select</code> function is a great way to subset your data to focus on only the columns you are particularly concerned with.</p>
</div>
<div id="the-filter-function" class="section level2" number="5.4">
<h2><span class="header-section-number">5.4</span> The <code>filter</code> function</h2>
<p>The <code>filter</code> function is one of the most powerful and frequently used functions when combined with a pipe. The filter function filters your data set based on some criteria you choose. For example, suppose we want to only look at children in this data set. We can filter out all of the passengers in the data set that have an age less than 18. Observe:</p>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="cleaning-data-i.html#cb72-1" aria-hidden="true" tabindex="-1"></a>titanic <span class="sc">%&gt;%</span> </span>
<span id="cb72-2"><a href="cleaning-data-i.html#cb72-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(age <span class="sc">&lt;</span> <span class="dv">18</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb72-3"><a href="cleaning-data-i.html#cb72-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>()</span></code></pre></div>
<pre><code>## # A tibble: 6 × 12
##   passenger_id survived pclass name  sex     age sib_sp parch ticket  fare cabin
##          &lt;int&gt;    &lt;int&gt;  &lt;int&gt; &lt;chr&gt; &lt;chr&gt; &lt;dbl&gt;  &lt;int&gt; &lt;int&gt; &lt;chr&gt;  &lt;dbl&gt; &lt;chr&gt;
## 1            8        0      3 &quot;Pal… male      2      3     1 349909 21.1  &quot;&quot;   
## 2           10        1      2 &quot;Nas… fema…    14      1     0 237736 30.1  &quot;&quot;   
## 3           11        1      3 &quot;San… fema…     4      1     1 PP 95… 16.7  &quot;G6&quot; 
## 4           15        0      3 &quot;Ves… fema…    14      0     0 350406  7.85 &quot;&quot;   
## 5           17        0      3 &quot;Ric… male      2      4     1 382652 29.1  &quot;&quot;   
## 6           23        1      3 &quot;McG… fema…    15      0     0 330923  8.03 &quot;&quot;   
## # … with 1 more variable: embarked &lt;chr&gt;</code></pre>
<p>Just to further our understanding, let’s once again write out what this code is doing:</p>
<ul>
<li>Use the titanic tibble</li>
<li>And then filter out only rows that have <code>age</code> equal to “Child”</li>
<li>And then give the heading of the tibble</li>
</ul>
<div id="exercise-6" class="section level3" number="5.4.1">
<h3><span class="header-section-number">5.4.1</span> Exercise</h3>
<ul>
<li>Filter the rows of the <code>titanic</code> tibble such that the column <code>fare</code> column is greater than 100.</li>
</ul>
</div>
</div>
<div id="the-distinct-function" class="section level2" number="5.5">
<h2><span class="header-section-number">5.5</span> The <code>distinct</code> function</h2>
<p>The <code>distinct</code> function allows you to see the unique values within a specified column. For instance, suppose we wanted to know all of the unique values that are within the <code>pclass</code> column of the <code>titanic</code> tibble. We could use the <code>distinct</code> function to do this.</p>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="cleaning-data-i.html#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="do">## using distinct to find unique values in a column</span></span>
<span id="cb74-2"><a href="cleaning-data-i.html#cb74-2" aria-hidden="true" tabindex="-1"></a>titanic <span class="sc">%&gt;%</span> </span>
<span id="cb74-3"><a href="cleaning-data-i.html#cb74-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(pclass)</span></code></pre></div>
<pre><code>## # A tibble: 3 × 1
##   pclass
##    &lt;int&gt;
## 1      3
## 2      1
## 3      2</code></pre>
<p>We can see from the <code>distinct</code> function that the <code>pclass</code> column has three unique values: 1, 2, and 3 which correspond to the passengers’ class. The <code>distinct</code> function can be a great way to take a look at your data and figure out what kind of values reside within specific columns.</p>
<div id="exercise-7" class="section level3" number="5.5.1">
<h3><span class="header-section-number">5.5.1</span> Exercise</h3>
<ul>
<li>Using the <code>distinct</code> function, find the unique values of the <code>age</code> column.</li>
</ul>
</div>
</div>
<div id="the-mutate-function." class="section level2" number="5.6">
<h2><span class="header-section-number">5.6</span> The <code>mutate</code> function.</h2>
<p>The <code>mutate</code> function creates a new column in your tibble based on some computation statement. To motivate this, suppose we wanted to create a column in the <code>titanic</code> tibble that is named <code>adjusted_fare</code> which takes the <code>fare</code> column and multiplies it by the rate of inflation to get the ticket fare in today’s prices. Using the <code>mutate</code> function, we could accomplish this:</p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="cleaning-data-i.html#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="do">## assigning a variable the inflation rate</span></span>
<span id="cb76-2"><a href="cleaning-data-i.html#cb76-2" aria-hidden="true" tabindex="-1"></a>inflation_rate <span class="ot">&lt;-</span> <span class="fl">27.14</span></span>
<span id="cb76-3"><a href="cleaning-data-i.html#cb76-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-4"><a href="cleaning-data-i.html#cb76-4" aria-hidden="true" tabindex="-1"></a><span class="do">## creating a new variable called adjusted_fare which will be the fare in today&#39;s dollars</span></span>
<span id="cb76-5"><a href="cleaning-data-i.html#cb76-5" aria-hidden="true" tabindex="-1"></a>titanic <span class="sc">%&gt;%</span> </span>
<span id="cb76-6"><a href="cleaning-data-i.html#cb76-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">adjusted_fare =</span> fare <span class="sc">*</span> inflation_rate) <span class="sc">%&gt;%</span> </span>
<span id="cb76-7"><a href="cleaning-data-i.html#cb76-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>()</span></code></pre></div>
<pre><code>## # A tibble: 6 × 13
##   passenger_id survived pclass name  sex     age sib_sp parch ticket  fare cabin
##          &lt;int&gt;    &lt;int&gt;  &lt;int&gt; &lt;chr&gt; &lt;chr&gt; &lt;dbl&gt;  &lt;int&gt; &lt;int&gt; &lt;chr&gt;  &lt;dbl&gt; &lt;chr&gt;
## 1            1        0      3 Brau… male     22      1     0 A/5 2…  7.25 &quot;&quot;   
## 2            2        1      1 Cumi… fema…    38      1     0 PC 17… 71.3  &quot;C85&quot;
## 3            3        1      3 Heik… fema…    26      0     0 STON/…  7.92 &quot;&quot;   
## 4            4        1      1 Futr… fema…    35      1     0 113803 53.1  &quot;C12…
## 5            5        0      3 Alle… male     35      0     0 373450  8.05 &quot;&quot;   
## 6            6        0      3 Mora… male     NA      0     0 330877  8.46 &quot;&quot;   
## # … with 2 more variables: embarked &lt;chr&gt;, adjusted_fare &lt;dbl&gt;</code></pre>
<p>There is actually quite a bit going on here, so it’s worth noting the syntax of the <code>mutate</code> function.</p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="cleaning-data-i.html#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="do">## mutate function syntax</span></span>
<span id="cb78-2"><a href="cleaning-data-i.html#cb78-2" aria-hidden="true" tabindex="-1"></a>titanic <span class="sc">%&gt;%</span> </span>
<span id="cb78-3"><a href="cleaning-data-i.html#cb78-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">your_variable_name =</span> some expression)</span></code></pre></div>
<p>Recall that the tibble <strong>will not</strong> save with this new variable that you created unless you tell it to do so.</p>
<p>Where <code>mutate</code> becomes very powerful is using in conjunction with the <code>ifelse</code> function. The <code>ifelse</code> function is a function that takes a conditional statement, and if it is TRUE, assigns a value, and if it is FALSE, assigns a different value. For instance, suppose we want to create a binary variable equal to 1 if a person is under the age of 18 and 0 if are not. Hence, we can use the <code>ifelse</code> function to create our desired binary variable. The syntax for the <code>ifelse</code> function is as follows:</p>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="cleaning-data-i.html#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="do">## ifelse syntax</span></span>
<span id="cb79-2"><a href="cleaning-data-i.html#cb79-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ifelse</span>(a condition, value <span class="cf">if</span> condition is <span class="cn">TRUE</span>, value <span class="cf">if</span> condition is <span class="cn">FALSE</span>)</span></code></pre></div>
<p>This will be more clear once you see it in action. Let’s actually create the desired binary variable:</p>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="cleaning-data-i.html#cb80-1" aria-hidden="true" tabindex="-1"></a>titanic <span class="sc">%&gt;%</span> </span>
<span id="cb80-2"><a href="cleaning-data-i.html#cb80-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">child =</span> <span class="fu">ifelse</span>(age <span class="sc">&lt;</span> <span class="dv">18</span>, <span class="dv">1</span>, <span class="dv">0</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb80-3"><a href="cleaning-data-i.html#cb80-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>()</span></code></pre></div>
<pre><code>## # A tibble: 6 × 13
##   passenger_id survived pclass name  sex     age sib_sp parch ticket  fare cabin
##          &lt;int&gt;    &lt;int&gt;  &lt;int&gt; &lt;chr&gt; &lt;chr&gt; &lt;dbl&gt;  &lt;int&gt; &lt;int&gt; &lt;chr&gt;  &lt;dbl&gt; &lt;chr&gt;
## 1            1        0      3 Brau… male     22      1     0 A/5 2…  7.25 &quot;&quot;   
## 2            2        1      1 Cumi… fema…    38      1     0 PC 17… 71.3  &quot;C85&quot;
## 3            3        1      3 Heik… fema…    26      0     0 STON/…  7.92 &quot;&quot;   
## 4            4        1      1 Futr… fema…    35      1     0 113803 53.1  &quot;C12…
## 5            5        0      3 Alle… male     35      0     0 373450  8.05 &quot;&quot;   
## 6            6        0      3 Mora… male     NA      0     0 330877  8.46 &quot;&quot;   
## # … with 2 more variables: embarked &lt;chr&gt;, child &lt;dbl&gt;</code></pre>
<p>Since we cannot see from the preview that we actually created a binary variable, let’s use the <code>distinct</code> function as a check.</p>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="cleaning-data-i.html#cb82-1" aria-hidden="true" tabindex="-1"></a>titanic <span class="sc">%&gt;%</span> </span>
<span id="cb82-2"><a href="cleaning-data-i.html#cb82-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">child =</span> <span class="fu">ifelse</span>(age <span class="sc">&lt;</span> <span class="dv">18</span>, <span class="dv">1</span>, <span class="dv">0</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb82-3"><a href="cleaning-data-i.html#cb82-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(child)</span></code></pre></div>
<pre><code>## # A tibble: 3 × 1
##   child
##   &lt;dbl&gt;
## 1     0
## 2    NA
## 3     1</code></pre>
<p><strong>REMEMBER</strong> the <code>child</code> variable <strong>DID NOT</strong> save unless you specifically tell R to do so. We will save this variable as we will use it later.</p>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="cleaning-data-i.html#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="do">## saving the new variable</span></span>
<span id="cb84-2"><a href="cleaning-data-i.html#cb84-2" aria-hidden="true" tabindex="-1"></a>titanic <span class="ot">&lt;-</span> titanic <span class="sc">%&gt;%</span> </span>
<span id="cb84-3"><a href="cleaning-data-i.html#cb84-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">child =</span> <span class="fu">ifelse</span>(age <span class="sc">&lt;</span> <span class="dv">18</span>, <span class="dv">1</span>, <span class="dv">0</span>))</span>
<span id="cb84-4"><a href="cleaning-data-i.html#cb84-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-5"><a href="cleaning-data-i.html#cb84-5" aria-hidden="true" tabindex="-1"></a><span class="do">## observing the first 5 rows</span></span>
<span id="cb84-6"><a href="cleaning-data-i.html#cb84-6" aria-hidden="true" tabindex="-1"></a>titanic <span class="sc">%&gt;%</span></span>
<span id="cb84-7"><a href="cleaning-data-i.html#cb84-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>()</span></code></pre></div>
<pre><code>## # A tibble: 6 × 13
##   passenger_id survived pclass name  sex     age sib_sp parch ticket  fare cabin
##          &lt;int&gt;    &lt;int&gt;  &lt;int&gt; &lt;chr&gt; &lt;chr&gt; &lt;dbl&gt;  &lt;int&gt; &lt;int&gt; &lt;chr&gt;  &lt;dbl&gt; &lt;chr&gt;
## 1            1        0      3 Brau… male     22      1     0 A/5 2…  7.25 &quot;&quot;   
## 2            2        1      1 Cumi… fema…    38      1     0 PC 17… 71.3  &quot;C85&quot;
## 3            3        1      3 Heik… fema…    26      0     0 STON/…  7.92 &quot;&quot;   
## 4            4        1      1 Futr… fema…    35      1     0 113803 53.1  &quot;C12…
## 5            5        0      3 Alle… male     35      0     0 373450  8.05 &quot;&quot;   
## 6            6        0      3 Mora… male     NA      0     0 330877  8.46 &quot;&quot;   
## # … with 2 more variables: embarked &lt;chr&gt;, child &lt;dbl&gt;</code></pre>
</div>
<div id="the-summarize-function" class="section level2" number="5.7">
<h2><span class="header-section-number">5.7</span> The <code>summarize</code> function</h2>
<p>The <code>summarize</code> function allows us to create statistics over columns quickly and efficiently. As a demonstration, we will be focusing on our <code>survived</code> column. Let’s suppose that we wanted to know the average of <code>survived</code>. Since this is a binary variable, this would be equivalent to the proportion of people who survived the titanic.</p>
<p>Now let’s make a new column called <code>proportion_survived</code> which is equal to the mean of <code>survived</code>.</p>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="cleaning-data-i.html#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="do">## finding the average of the survived column</span></span>
<span id="cb86-2"><a href="cleaning-data-i.html#cb86-2" aria-hidden="true" tabindex="-1"></a>titanic <span class="sc">%&gt;%</span> </span>
<span id="cb86-3"><a href="cleaning-data-i.html#cb86-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">proportion_survived =</span> <span class="fu">mean</span>(survived, <span class="at">na.rm =</span> T))</span></code></pre></div>
<pre><code>## # A tibble: 1 × 1
##   proportion_survived
##                 &lt;dbl&gt;
## 1               0.384</code></pre>
<p>Take a closer look at the <code>summarize</code> function. You can think of the <code>summarize</code> function as similar to the <code>mutate</code> function as it creates a new variable equal to some summary statistic that you tell it to do. The basic syntax for the <code>summarize</code> function is as follows:</p>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="cleaning-data-i.html#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summarize</span>(<span class="at">your_variable_name =</span> somefunction)</span></code></pre></div>
<p>As another example, we could find the standard deviation of the <code>survived</code> column using the summarize function.</p>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="cleaning-data-i.html#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="do">##finding the standard deviation of the survived column</span></span>
<span id="cb89-2"><a href="cleaning-data-i.html#cb89-2" aria-hidden="true" tabindex="-1"></a>titanic <span class="sc">%&gt;%</span> </span>
<span id="cb89-3"><a href="cleaning-data-i.html#cb89-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">sd_survived =</span> <span class="fu">sd</span>(survived, <span class="at">na.rm =</span> T))</span></code></pre></div>
<pre><code>## # A tibble: 1 × 1
##   sd_survived
##         &lt;dbl&gt;
## 1       0.487</code></pre>
<div id="exercise-8" class="section level3" number="5.7.1">
<h3><span class="header-section-number">5.7.1</span> Exercise</h3>
<ul>
<li>Find the variance of the <code>survived</code> column using the <code>summarize</code> function. See solutions at the end of the document.</li>
</ul>
</div>
</div>
<div id="the-group_by-and-summarize-functions" class="section level2" number="5.8">
<h2><span class="header-section-number">5.8</span> The <code>group_by</code> and <code>summarize</code> functions</h2>
<p>The <code>group_by</code> and <code>summarize</code> functions work together to make computing statistics within-groups easy. Suppose you wanted to know the average rate of survival by class type on the titanic. In other words, you suspect that the survival rate differs by people of different class To do this, you want to take the average of each group. The <code>group_by</code> function will group classes together and then the <code>summarize</code> function will be able to do summary statistics on each group individually.</p>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="cleaning-data-i.html#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="do">## finding the survival rate among classes</span></span>
<span id="cb91-2"><a href="cleaning-data-i.html#cb91-2" aria-hidden="true" tabindex="-1"></a>titanic <span class="sc">%&gt;%</span> </span>
<span id="cb91-3"><a href="cleaning-data-i.html#cb91-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(pclass) <span class="sc">%&gt;%</span> </span>
<span id="cb91-4"><a href="cleaning-data-i.html#cb91-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">survival_rate =</span> <span class="fu">mean</span>(survived, <span class="at">na.rm =</span> T))</span></code></pre></div>
<pre><code>## # A tibble: 3 × 2
##   pclass survival_rate
##    &lt;int&gt;         &lt;dbl&gt;
## 1      1         0.630
## 2      2         0.473
## 3      3         0.242</code></pre>
<p>From here you can see that the survival rate greatly varied across different classes. It appears that survival was much more prevalent for higher class people. An interesting result! Let’s also review what is happening here in the language of pipes:</p>
<ul>
<li>Take the <code>titanic</code> data</li>
<li>And now group by class</li>
<li>And now summarize the survival rate by creating a column equal to the mean of the <code>survived</code> column within each class.</li>
</ul>
<p>You may be curious what happens when you do a <code>group_by</code> without a <code>summarize</code>. The truth is, nothing happens! R will create a grouping, but it means nothing unless you actually perform some sort of meaningful statistic on each group.</p>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="cleaning-data-i.html#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="do">## using a group_by without a summarize or following function does nothing</span></span>
<span id="cb93-2"><a href="cleaning-data-i.html#cb93-2" aria-hidden="true" tabindex="-1"></a>titanic <span class="sc">%&gt;%</span> </span>
<span id="cb93-3"><a href="cleaning-data-i.html#cb93-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(sex)</span></code></pre></div>
<pre><code>## # A tibble: 891 × 13
## # Groups:   sex [2]
##    passenger_id survived pclass name       sex     age sib_sp parch ticket  fare
##           &lt;int&gt;    &lt;int&gt;  &lt;int&gt; &lt;chr&gt;      &lt;chr&gt; &lt;dbl&gt;  &lt;int&gt; &lt;int&gt; &lt;chr&gt;  &lt;dbl&gt;
##  1            1        0      3 Braund, M… male     22      1     0 A/5 2…  7.25
##  2            2        1      1 Cumings, … fema…    38      1     0 PC 17… 71.3 
##  3            3        1      3 Heikkinen… fema…    26      0     0 STON/…  7.92
##  4            4        1      1 Futrelle,… fema…    35      1     0 113803 53.1 
##  5            5        0      3 Allen, Mr… male     35      0     0 373450  8.05
##  6            6        0      3 Moran, Mr… male     NA      0     0 330877  8.46
##  7            7        0      1 McCarthy,… male     54      0     0 17463  51.9 
##  8            8        0      3 Palsson, … male      2      3     1 349909 21.1 
##  9            9        1      3 Johnson, … fema…    27      0     2 347742 11.1 
## 10           10        1      2 Nasser, M… fema…    14      1     0 237736 30.1 
## # … with 881 more rows, and 3 more variables: cabin &lt;chr&gt;, embarked &lt;chr&gt;,
## #   child &lt;dbl&gt;</code></pre>
<p>Since it is imperative to understand the <code>group_by</code> followed by the <code>summarize</code> function, try out a couple of exercises.</p>
</div>
<div id="exercise-9" class="section level2" number="5.9">
<h2><span class="header-section-number">5.9</span> Exercise</h2>
<ul>
<li>Did women have a higher rate of survival than males? Find the answer to this question using the <code>group_by</code> and <code>summarize</code> functions.</li>
</ul>
<div id="exercise-10" class="section level3" number="5.9.1">
<h3><span class="header-section-number">5.9.1</span> Exercise</h3>
<ul>
<li>Is there a difference in survival rates between women and men who were in a higher class? Using the <code>group_by</code> and <code>summarize</code> functions, find the answer to this question. Hint: put two arguments in the <code>group_by</code> function.</li>
</ul>
<pre><code>## `summarise()` has grouped output by &#39;sex&#39;. You can override using the `.groups` argument.</code></pre>
</div>
</div>
<div id="selected-solutions-1" class="section level2" number="5.10">
<h2><span class="header-section-number">5.10</span> Selected Solutions</h2>
<ul>
<li>(Exercise 1.7.1) Variance = 0.24</li>
<li>(Exercise 1.8.1) Women had higher survival rates at 0.74. Males were at 0.19.</li>
<li>(Exercise 1.8.2) Females in first, second, and third class had survivals rate of 0.97, 0.92, and 0.5 respectively. On the other hand, males in first, second, and third class had survival rates of 0.37, 0.16, and 0.14 respectively.</li>
</ul>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="git-and-github.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="data-cleaning-ii.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/jules32/bookdown-tutorial/edit/master/intro_piping.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["series.pdf"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
